{"abi":[],"bytecode":{"object":"0x6055604b600b8282823980515f1a607314603f577f4e487b71000000000000000000000000000000000000000000000000000000005f525f60045260245ffd5b305f52607381538281f3fe730000000000000000000000000000000000000000301460806040525f80fdfea2646970667358221220025110f51641c8cac0d7098e801cc6b3b9168b36ba4cc6bd9490bf69ce3f0cc764736f6c63430008150033","sourceMap":"425:1934:26:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x730000000000000000000000000000000000000000301460806040525f80fdfea2646970667358221220025110f51641c8cac0d7098e801cc6b3b9168b36ba4cc6bd9490bf69ce3f0cc764736f6c63430008150033","sourceMap":"425:1934:26:-:0;;;;;;;;","linkReferences":{}},"methodIdentifiers":{},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.21+commit.d9974bed\"},\"language\":\"Solidity\",\"output\":{\"abi\":[],\"devdoc\":{\"author\":\"Morpho Labs\",\"custom:contact\":\"security@morpho.org\",\"details\":\"This implementation mitigates share price manipulations, using OpenZeppelin's method of virtual shares: https://docs.openzeppelin.com/contracts/4.x/erc4626#inflation-attack.\",\"kind\":\"dev\",\"methods\":{},\"stateVariables\":{\"VIRTUAL_ASSETS\":{\"details\":\"A number of virtual assets of 1 enforces a conversion rate between shares and assets when a market is empty.\"},\"VIRTUAL_SHARES\":{\"details\":\"The number of virtual shares has been chosen low enough to prevent overflows, and high enough to ensure high precision computations.Virtual shares can never be redeemed for the assets they are entitled to, but it is assumed the share price stays low enough not to inflate these assets to a significant value.Warning: The assets to which virtual borrow shares are entitled behave like unrealizable bad debt.\"}},\"title\":\"SharesMathLib\",\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"notice\":\"Shares management library.\",\"version\":1}},\"settings\":{\"compilationTarget\":{\"lib/metamorpho/lib/morpho-blue/src/libraries/SharesMathLib.sol\":\"SharesMathLib\"},\"evmVersion\":\"shanghai\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":false,\"runs\":200},\"remappings\":[\":@openzeppelin/contracts/=lib/openzeppelin-contracts/contracts/\",\":ds-test/=lib/metamorpho/lib/forge-std/lib/ds-test/src/\",\":erc4626-tests/=lib/metamorpho/lib/erc4626-tests/\",\":forge-std/=lib/forge-std/src/\",\":halmos-cheatcodes/=lib/openzeppelin-contracts/lib/halmos-cheatcodes/src/\",\":metamorpho-test/=lib/metamorpho/test/forge/\",\":metamorpho/=lib/metamorpho/src/\",\":morpho-blue/=lib/metamorpho/lib/morpho-blue/src/\",\":murky/=lib/metamorpho/lib/universal-rewards-distributor/lib/murky/src/\",\":openzeppelin-contracts/=lib/openzeppelin-contracts/contracts/\",\":openzeppelin/=lib/metamorpho/lib/universal-rewards-distributor/lib/openzeppelin-contracts/contracts/\",\":universal-rewards-distributor/=lib/metamorpho/lib/universal-rewards-distributor/src/\"]},\"sources\":{\"lib/metamorpho/lib/morpho-blue/src/libraries/MathLib.sol\":{\"keccak256\":\"0xa7354cbbcecef7bc0c94b61061c4e5da75515056b8e2db65e826b00d7369744a\",\"license\":\"GPL-2.0-or-later\",\"urls\":[\"bzz-raw://d7419c59bb906fcfa49320b68f265c3200090e5c30b194766256aee70b012e08\",\"dweb:/ipfs/Qmbo4uaW6XYnudya4bb6RU6riWXFk5M3CWJge5XzTTaEfd\"]},\"lib/metamorpho/lib/morpho-blue/src/libraries/SharesMathLib.sol\":{\"keccak256\":\"0xe6d1c0ee97239bcda3ca8429fdbad2486faf4192312ce6c4b322772e038f01a8\",\"license\":\"GPL-2.0-or-later\",\"urls\":[\"bzz-raw://0cf520d5984e253a2d2a9abe195c2d8a6c33b3cddc049175e93a5f22e9972c11\",\"dweb:/ipfs/QmP8rkFEMhx8X7jxtRUkLcq3MdFkTr3nxzof3vzwGhab8p\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.21+commit.d9974bed"},"language":"Solidity","output":{"abi":[],"devdoc":{"kind":"dev","methods":{},"version":1},"userdoc":{"kind":"user","methods":{},"version":1}},"settings":{"remappings":["@openzeppelin/contracts/=lib/openzeppelin-contracts/contracts/","ds-test/=lib/metamorpho/lib/forge-std/lib/ds-test/src/","erc4626-tests/=lib/metamorpho/lib/erc4626-tests/","forge-std/=lib/forge-std/src/","halmos-cheatcodes/=lib/openzeppelin-contracts/lib/halmos-cheatcodes/src/","metamorpho-test/=lib/metamorpho/test/forge/","metamorpho/=lib/metamorpho/src/","morpho-blue/=lib/metamorpho/lib/morpho-blue/src/","murky/=lib/metamorpho/lib/universal-rewards-distributor/lib/murky/src/","openzeppelin-contracts/=lib/openzeppelin-contracts/contracts/","openzeppelin/=lib/metamorpho/lib/universal-rewards-distributor/lib/openzeppelin-contracts/contracts/","universal-rewards-distributor/=lib/metamorpho/lib/universal-rewards-distributor/src/"],"optimizer":{"enabled":false,"runs":200},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"lib/metamorpho/lib/morpho-blue/src/libraries/SharesMathLib.sol":"SharesMathLib"},"evmVersion":"shanghai","libraries":{}},"sources":{"lib/metamorpho/lib/morpho-blue/src/libraries/MathLib.sol":{"keccak256":"0xa7354cbbcecef7bc0c94b61061c4e5da75515056b8e2db65e826b00d7369744a","urls":["bzz-raw://d7419c59bb906fcfa49320b68f265c3200090e5c30b194766256aee70b012e08","dweb:/ipfs/Qmbo4uaW6XYnudya4bb6RU6riWXFk5M3CWJge5XzTTaEfd"],"license":"GPL-2.0-or-later"},"lib/metamorpho/lib/morpho-blue/src/libraries/SharesMathLib.sol":{"keccak256":"0xe6d1c0ee97239bcda3ca8429fdbad2486faf4192312ce6c4b322772e038f01a8","urls":["bzz-raw://0cf520d5984e253a2d2a9abe195c2d8a6c33b3cddc049175e93a5f22e9972c11","dweb:/ipfs/QmP8rkFEMhx8X7jxtRUkLcq3MdFkTr3nxzof3vzwGhab8p"],"license":"GPL-2.0-or-later"}},"version":1},"ast":{"absolutePath":"lib/metamorpho/lib/morpho-blue/src/libraries/SharesMathLib.sol","id":44229,"exportedSymbols":{"MathLib":[44119],"SharesMathLib":[44228]},"nodeType":"SourceUnit","src":"45:2315:26","nodes":[{"id":44121,"nodeType":"PragmaDirective","src":"45:23:26","nodes":[],"literals":["solidity","^","0.8",".0"]},{"id":44123,"nodeType":"ImportDirective","src":"70:38:26","nodes":[],"absolutePath":"lib/metamorpho/lib/morpho-blue/src/libraries/MathLib.sol","file":"./MathLib.sol","nameLocation":"-1:-1:-1","scope":44229,"sourceUnit":44120,"symbolAliases":[{"foreign":{"id":44122,"name":"MathLib","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":44119,"src":"78:7:26","typeDescriptions":{}},"nameLocation":"-1:-1:-1"}],"unitAlias":""},{"id":44228,"nodeType":"ContractDefinition","src":"425:1934:26","nodes":[{"id":44127,"nodeType":"UsingForDirective","src":"453:26:26","nodes":[],"global":false,"libraryName":{"id":44125,"name":"MathLib","nameLocations":["459:7:26"],"nodeType":"IdentifierPath","referencedDeclaration":44119,"src":"459:7:26"},"typeName":{"id":44126,"name":"uint256","nodeType":"ElementaryTypeName","src":"471:7:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}}},{"id":44131,"nodeType":"VariableDeclaration","src":"949:46:26","nodes":[],"constant":true,"documentation":{"id":44128,"nodeType":"StructuredDocumentation","src":"485:459:26","text":"@dev The number of virtual shares has been chosen low enough to prevent overflows, and high enough to ensure\n high precision computations.\n @dev Virtual shares can never be redeemed for the assets they are entitled to, but it is assumed the share price\n stays low enough not to inflate these assets to a significant value.\n @dev Warning: The assets to which virtual borrow shares are entitled behave like unrealizable bad debt."},"mutability":"constant","name":"VIRTUAL_SHARES","nameLocation":"975:14:26","scope":44228,"stateVariable":true,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":44129,"name":"uint256","nodeType":"ElementaryTypeName","src":"949:7:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"value":{"hexValue":"316536","id":44130,"isConstant":false,"isLValue":false,"isPure":true,"kind":"number","lValueRequested":false,"nodeType":"Literal","src":"992:3:26","typeDescriptions":{"typeIdentifier":"t_rational_1000000_by_1","typeString":"int_const 1000000"},"value":"1e6"},"visibility":"internal"},{"id":44135,"nodeType":"VariableDeclaration","src":"1132:44:26","nodes":[],"constant":true,"documentation":{"id":44132,"nodeType":"StructuredDocumentation","src":"1002:125:26","text":"@dev A number of virtual assets of 1 enforces a conversion rate between shares and assets when a market is\n empty."},"mutability":"constant","name":"VIRTUAL_ASSETS","nameLocation":"1158:14:26","scope":44228,"stateVariable":true,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":44133,"name":"uint256","nodeType":"ElementaryTypeName","src":"1132:7:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"value":{"hexValue":"31","id":44134,"isConstant":false,"isLValue":false,"isPure":true,"kind":"number","lValueRequested":false,"nodeType":"Literal","src":"1175:1:26","typeDescriptions":{"typeIdentifier":"t_rational_1_by_1","typeString":"int_const 1"},"value":"1"},"visibility":"internal"},{"id":44158,"nodeType":"FunctionDefinition","src":"1262:213:26","nodes":[],"body":{"id":44157,"nodeType":"Block","src":"1374:101:26","nodes":[],"statements":[{"expression":{"arguments":[{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":44151,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":44149,"name":"totalShares","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":44142,"src":"1409:11:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"+","rightExpression":{"id":44150,"name":"VIRTUAL_SHARES","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":44131,"src":"1423:14:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"1409:28:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":44154,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":44152,"name":"totalAssets","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":44140,"src":"1439:11:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"+","rightExpression":{"id":44153,"name":"VIRTUAL_ASSETS","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":44135,"src":"1453:14:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"1439:28:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_uint256","typeString":"uint256"},{"typeIdentifier":"t_uint256","typeString":"uint256"}],"expression":{"id":44147,"name":"assets","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":44138,"src":"1391:6:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"id":44148,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"1398:10:26","memberName":"mulDivDown","nodeType":"MemberAccess","referencedDeclaration":44050,"src":"1391:17:26","typeDescriptions":{"typeIdentifier":"t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$","typeString":"function (uint256,uint256,uint256) pure returns (uint256)"}},"id":44155,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"1391:77:26","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"functionReturnParameters":44146,"id":44156,"nodeType":"Return","src":"1384:84:26"}]},"documentation":{"id":44136,"nodeType":"StructuredDocumentation","src":"1183:74:26","text":"@dev Calculates the value of `assets` quoted in shares, rounding down."},"implemented":true,"kind":"function","modifiers":[],"name":"toSharesDown","nameLocation":"1271:12:26","parameters":{"id":44143,"nodeType":"ParameterList","parameters":[{"constant":false,"id":44138,"mutability":"mutable","name":"assets","nameLocation":"1292:6:26","nodeType":"VariableDeclaration","scope":44158,"src":"1284:14:26","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":44137,"name":"uint256","nodeType":"ElementaryTypeName","src":"1284:7:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},{"constant":false,"id":44140,"mutability":"mutable","name":"totalAssets","nameLocation":"1308:11:26","nodeType":"VariableDeclaration","scope":44158,"src":"1300:19:26","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":44139,"name":"uint256","nodeType":"ElementaryTypeName","src":"1300:7:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},{"constant":false,"id":44142,"mutability":"mutable","name":"totalShares","nameLocation":"1329:11:26","nodeType":"VariableDeclaration","scope":44158,"src":"1321:19:26","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":44141,"name":"uint256","nodeType":"ElementaryTypeName","src":"1321:7:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"src":"1283:58:26"},"returnParameters":{"id":44146,"nodeType":"ParameterList","parameters":[{"constant":false,"id":44145,"mutability":"mutable","name":"","nameLocation":"-1:-1:-1","nodeType":"VariableDeclaration","scope":44158,"src":"1365:7:26","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":44144,"name":"uint256","nodeType":"ElementaryTypeName","src":"1365:7:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"src":"1364:9:26"},"scope":44228,"stateMutability":"pure","virtual":false,"visibility":"internal"},{"id":44181,"nodeType":"FunctionDefinition","src":"1560:213:26","nodes":[],"body":{"id":44180,"nodeType":"Block","src":"1672:101:26","nodes":[],"statements":[{"expression":{"arguments":[{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":44174,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":44172,"name":"totalAssets","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":44163,"src":"1707:11:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"+","rightExpression":{"id":44173,"name":"VIRTUAL_ASSETS","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":44135,"src":"1721:14:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"1707:28:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":44177,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":44175,"name":"totalShares","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":44165,"src":"1737:11:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"+","rightExpression":{"id":44176,"name":"VIRTUAL_SHARES","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":44131,"src":"1751:14:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"1737:28:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_uint256","typeString":"uint256"},{"typeIdentifier":"t_uint256","typeString":"uint256"}],"expression":{"id":44170,"name":"shares","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":44161,"src":"1689:6:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"id":44171,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"1696:10:26","memberName":"mulDivDown","nodeType":"MemberAccess","referencedDeclaration":44050,"src":"1689:17:26","typeDescriptions":{"typeIdentifier":"t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$","typeString":"function (uint256,uint256,uint256) pure returns (uint256)"}},"id":44178,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"1689:77:26","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"functionReturnParameters":44169,"id":44179,"nodeType":"Return","src":"1682:84:26"}]},"documentation":{"id":44159,"nodeType":"StructuredDocumentation","src":"1481:74:26","text":"@dev Calculates the value of `shares` quoted in assets, rounding down."},"implemented":true,"kind":"function","modifiers":[],"name":"toAssetsDown","nameLocation":"1569:12:26","parameters":{"id":44166,"nodeType":"ParameterList","parameters":[{"constant":false,"id":44161,"mutability":"mutable","name":"shares","nameLocation":"1590:6:26","nodeType":"VariableDeclaration","scope":44181,"src":"1582:14:26","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":44160,"name":"uint256","nodeType":"ElementaryTypeName","src":"1582:7:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},{"constant":false,"id":44163,"mutability":"mutable","name":"totalAssets","nameLocation":"1606:11:26","nodeType":"VariableDeclaration","scope":44181,"src":"1598:19:26","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":44162,"name":"uint256","nodeType":"ElementaryTypeName","src":"1598:7:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},{"constant":false,"id":44165,"mutability":"mutable","name":"totalShares","nameLocation":"1627:11:26","nodeType":"VariableDeclaration","scope":44181,"src":"1619:19:26","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":44164,"name":"uint256","nodeType":"ElementaryTypeName","src":"1619:7:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"src":"1581:58:26"},"returnParameters":{"id":44169,"nodeType":"ParameterList","parameters":[{"constant":false,"id":44168,"mutability":"mutable","name":"","nameLocation":"-1:-1:-1","nodeType":"VariableDeclaration","scope":44181,"src":"1663:7:26","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":44167,"name":"uint256","nodeType":"ElementaryTypeName","src":"1663:7:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"src":"1662:9:26"},"scope":44228,"stateMutability":"pure","virtual":false,"visibility":"internal"},{"id":44204,"nodeType":"FunctionDefinition","src":"1856:209:26","nodes":[],"body":{"id":44203,"nodeType":"Block","src":"1966:99:26","nodes":[],"statements":[{"expression":{"arguments":[{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":44197,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":44195,"name":"totalShares","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":44188,"src":"1999:11:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"+","rightExpression":{"id":44196,"name":"VIRTUAL_SHARES","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":44131,"src":"2013:14:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"1999:28:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":44200,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":44198,"name":"totalAssets","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":44186,"src":"2029:11:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"+","rightExpression":{"id":44199,"name":"VIRTUAL_ASSETS","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":44135,"src":"2043:14:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"2029:28:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_uint256","typeString":"uint256"},{"typeIdentifier":"t_uint256","typeString":"uint256"}],"expression":{"id":44193,"name":"assets","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":44184,"src":"1983:6:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"id":44194,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"1990:8:26","memberName":"mulDivUp","nodeType":"MemberAccess","referencedDeclaration":44075,"src":"1983:15:26","typeDescriptions":{"typeIdentifier":"t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$","typeString":"function (uint256,uint256,uint256) pure returns (uint256)"}},"id":44201,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"1983:75:26","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"functionReturnParameters":44192,"id":44202,"nodeType":"Return","src":"1976:82:26"}]},"documentation":{"id":44182,"nodeType":"StructuredDocumentation","src":"1779:72:26","text":"@dev Calculates the value of `assets` quoted in shares, rounding up."},"implemented":true,"kind":"function","modifiers":[],"name":"toSharesUp","nameLocation":"1865:10:26","parameters":{"id":44189,"nodeType":"ParameterList","parameters":[{"constant":false,"id":44184,"mutability":"mutable","name":"assets","nameLocation":"1884:6:26","nodeType":"VariableDeclaration","scope":44204,"src":"1876:14:26","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":44183,"name":"uint256","nodeType":"ElementaryTypeName","src":"1876:7:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},{"constant":false,"id":44186,"mutability":"mutable","name":"totalAssets","nameLocation":"1900:11:26","nodeType":"VariableDeclaration","scope":44204,"src":"1892:19:26","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":44185,"name":"uint256","nodeType":"ElementaryTypeName","src":"1892:7:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},{"constant":false,"id":44188,"mutability":"mutable","name":"totalShares","nameLocation":"1921:11:26","nodeType":"VariableDeclaration","scope":44204,"src":"1913:19:26","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":44187,"name":"uint256","nodeType":"ElementaryTypeName","src":"1913:7:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"src":"1875:58:26"},"returnParameters":{"id":44192,"nodeType":"ParameterList","parameters":[{"constant":false,"id":44191,"mutability":"mutable","name":"","nameLocation":"-1:-1:-1","nodeType":"VariableDeclaration","scope":44204,"src":"1957:7:26","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":44190,"name":"uint256","nodeType":"ElementaryTypeName","src":"1957:7:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"src":"1956:9:26"},"scope":44228,"stateMutability":"pure","virtual":false,"visibility":"internal"},{"id":44227,"nodeType":"FunctionDefinition","src":"2148:209:26","nodes":[],"body":{"id":44226,"nodeType":"Block","src":"2258:99:26","nodes":[],"statements":[{"expression":{"arguments":[{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":44220,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":44218,"name":"totalAssets","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":44209,"src":"2291:11:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"+","rightExpression":{"id":44219,"name":"VIRTUAL_ASSETS","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":44135,"src":"2305:14:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"2291:28:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":44223,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":44221,"name":"totalShares","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":44211,"src":"2321:11:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"+","rightExpression":{"id":44222,"name":"VIRTUAL_SHARES","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":44131,"src":"2335:14:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"2321:28:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_uint256","typeString":"uint256"},{"typeIdentifier":"t_uint256","typeString":"uint256"}],"expression":{"id":44216,"name":"shares","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":44207,"src":"2275:6:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"id":44217,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"2282:8:26","memberName":"mulDivUp","nodeType":"MemberAccess","referencedDeclaration":44075,"src":"2275:15:26","typeDescriptions":{"typeIdentifier":"t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$","typeString":"function (uint256,uint256,uint256) pure returns (uint256)"}},"id":44224,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"2275:75:26","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"functionReturnParameters":44215,"id":44225,"nodeType":"Return","src":"2268:82:26"}]},"documentation":{"id":44205,"nodeType":"StructuredDocumentation","src":"2071:72:26","text":"@dev Calculates the value of `shares` quoted in assets, rounding up."},"implemented":true,"kind":"function","modifiers":[],"name":"toAssetsUp","nameLocation":"2157:10:26","parameters":{"id":44212,"nodeType":"ParameterList","parameters":[{"constant":false,"id":44207,"mutability":"mutable","name":"shares","nameLocation":"2176:6:26","nodeType":"VariableDeclaration","scope":44227,"src":"2168:14:26","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":44206,"name":"uint256","nodeType":"ElementaryTypeName","src":"2168:7:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},{"constant":false,"id":44209,"mutability":"mutable","name":"totalAssets","nameLocation":"2192:11:26","nodeType":"VariableDeclaration","scope":44227,"src":"2184:19:26","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":44208,"name":"uint256","nodeType":"ElementaryTypeName","src":"2184:7:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},{"constant":false,"id":44211,"mutability":"mutable","name":"totalShares","nameLocation":"2213:11:26","nodeType":"VariableDeclaration","scope":44227,"src":"2205:19:26","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":44210,"name":"uint256","nodeType":"ElementaryTypeName","src":"2205:7:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"src":"2167:58:26"},"returnParameters":{"id":44215,"nodeType":"ParameterList","parameters":[{"constant":false,"id":44214,"mutability":"mutable","name":"","nameLocation":"-1:-1:-1","nodeType":"VariableDeclaration","scope":44227,"src":"2249:7:26","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":44213,"name":"uint256","nodeType":"ElementaryTypeName","src":"2249:7:26","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"src":"2248:9:26"},"scope":44228,"stateMutability":"pure","virtual":false,"visibility":"internal"}],"abstract":false,"baseContracts":[],"canonicalName":"SharesMathLib","contractDependencies":[],"contractKind":"library","documentation":{"id":44124,"nodeType":"StructuredDocumentation","src":"110:315:26","text":"@title SharesMathLib\n @author Morpho Labs\n @custom:contact security@morpho.org\n @notice Shares management library.\n @dev This implementation mitigates share price manipulations, using OpenZeppelin's method of virtual shares:\n https://docs.openzeppelin.com/contracts/4.x/erc4626#inflation-attack."},"fullyImplemented":true,"linearizedBaseContracts":[44228],"name":"SharesMathLib","nameLocation":"433:13:26","scope":44229,"usedErrors":[],"usedEvents":[]}],"license":"GPL-2.0-or-later"},"id":26}