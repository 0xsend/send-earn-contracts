{"abi":[],"bytecode":{"object":"0x6055604b600b8282823980515f1a607314603f577f4e487b71000000000000000000000000000000000000000000000000000000005f525f60045260245ffd5b305f52607381538281f3fe730000000000000000000000000000000000000000301460806040525f80fdfea2646970667358221220025110f51641c8cac0d7098e801cc6b3b9168b36ba4cc6bd9490bf69ce3f0cc764736f6c63430008150033","sourceMap":"425:1934:49:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x730000000000000000000000000000000000000000301460806040525f80fdfea2646970667358221220025110f51641c8cac0d7098e801cc6b3b9168b36ba4cc6bd9490bf69ce3f0cc764736f6c63430008150033","sourceMap":"425:1934:49:-:0;;;;;;;;","linkReferences":{}},"methodIdentifiers":{},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.21+commit.d9974bed\"},\"language\":\"Solidity\",\"output\":{\"abi\":[],\"devdoc\":{\"author\":\"Morpho Labs\",\"custom:contact\":\"security@morpho.org\",\"details\":\"This implementation mitigates share price manipulations, using OpenZeppelin's method of virtual shares: https://docs.openzeppelin.com/contracts/4.x/erc4626#inflation-attack.\",\"kind\":\"dev\",\"methods\":{},\"stateVariables\":{\"VIRTUAL_ASSETS\":{\"details\":\"A number of virtual assets of 1 enforces a conversion rate between shares and assets when a market is empty.\"},\"VIRTUAL_SHARES\":{\"details\":\"The number of virtual shares has been chosen low enough to prevent overflows, and high enough to ensure high precision computations.Virtual shares can never be redeemed for the assets they are entitled to, but it is assumed the share price stays low enough not to inflate these assets to a significant value.Warning: The assets to which virtual borrow shares are entitled behave like unrealizable bad debt.\"}},\"title\":\"SharesMathLib\",\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"notice\":\"Shares management library.\",\"version\":1}},\"settings\":{\"compilationTarget\":{\"lib/metamorpho/lib/morpho-blue/src/libraries/SharesMathLib.sol\":\"SharesMathLib\"},\"evmVersion\":\"shanghai\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":false,\"runs\":200},\"remappings\":[\":@openzeppelin/contracts/=lib/openzeppelin-contracts/contracts/\",\":ds-test/=lib/metamorpho/lib/forge-std/lib/ds-test/src/\",\":erc4626-tests/=lib/metamorpho/lib/erc4626-tests/\",\":forge-std/=lib/forge-std/src/\",\":halmos-cheatcodes/=lib/openzeppelin-contracts/lib/halmos-cheatcodes/src/\",\":metamorpho-test/=lib/metamorpho/test/forge/\",\":metamorpho/=lib/metamorpho/src/\",\":morpho-blue/=lib/metamorpho/lib/morpho-blue/src/\",\":murky/=lib/metamorpho/lib/universal-rewards-distributor/lib/murky/src/\",\":openzeppelin-contracts/=lib/openzeppelin-contracts/contracts/\",\":openzeppelin/=lib/metamorpho/lib/universal-rewards-distributor/lib/openzeppelin-contracts/contracts/\",\":universal-rewards-distributor/=lib/metamorpho/lib/universal-rewards-distributor/src/\"]},\"sources\":{\"lib/metamorpho/lib/morpho-blue/src/libraries/MathLib.sol\":{\"keccak256\":\"0xa7354cbbcecef7bc0c94b61061c4e5da75515056b8e2db65e826b00d7369744a\",\"license\":\"GPL-2.0-or-later\",\"urls\":[\"bzz-raw://d7419c59bb906fcfa49320b68f265c3200090e5c30b194766256aee70b012e08\",\"dweb:/ipfs/Qmbo4uaW6XYnudya4bb6RU6riWXFk5M3CWJge5XzTTaEfd\"]},\"lib/metamorpho/lib/morpho-blue/src/libraries/SharesMathLib.sol\":{\"keccak256\":\"0xe6d1c0ee97239bcda3ca8429fdbad2486faf4192312ce6c4b322772e038f01a8\",\"license\":\"GPL-2.0-or-later\",\"urls\":[\"bzz-raw://0cf520d5984e253a2d2a9abe195c2d8a6c33b3cddc049175e93a5f22e9972c11\",\"dweb:/ipfs/QmP8rkFEMhx8X7jxtRUkLcq3MdFkTr3nxzof3vzwGhab8p\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.21+commit.d9974bed"},"language":"Solidity","output":{"abi":[],"devdoc":{"kind":"dev","methods":{},"version":1},"userdoc":{"kind":"user","methods":{},"version":1}},"settings":{"remappings":["@openzeppelin/contracts/=lib/openzeppelin-contracts/contracts/","ds-test/=lib/metamorpho/lib/forge-std/lib/ds-test/src/","erc4626-tests/=lib/metamorpho/lib/erc4626-tests/","forge-std/=lib/forge-std/src/","halmos-cheatcodes/=lib/openzeppelin-contracts/lib/halmos-cheatcodes/src/","metamorpho-test/=lib/metamorpho/test/forge/","metamorpho/=lib/metamorpho/src/","morpho-blue/=lib/metamorpho/lib/morpho-blue/src/","murky/=lib/metamorpho/lib/universal-rewards-distributor/lib/murky/src/","openzeppelin-contracts/=lib/openzeppelin-contracts/contracts/","openzeppelin/=lib/metamorpho/lib/universal-rewards-distributor/lib/openzeppelin-contracts/contracts/","universal-rewards-distributor/=lib/metamorpho/lib/universal-rewards-distributor/src/"],"optimizer":{"enabled":false,"runs":200},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"lib/metamorpho/lib/morpho-blue/src/libraries/SharesMathLib.sol":"SharesMathLib"},"evmVersion":"shanghai","libraries":{}},"sources":{"lib/metamorpho/lib/morpho-blue/src/libraries/MathLib.sol":{"keccak256":"0xa7354cbbcecef7bc0c94b61061c4e5da75515056b8e2db65e826b00d7369744a","urls":["bzz-raw://d7419c59bb906fcfa49320b68f265c3200090e5c30b194766256aee70b012e08","dweb:/ipfs/Qmbo4uaW6XYnudya4bb6RU6riWXFk5M3CWJge5XzTTaEfd"],"license":"GPL-2.0-or-later"},"lib/metamorpho/lib/morpho-blue/src/libraries/SharesMathLib.sol":{"keccak256":"0xe6d1c0ee97239bcda3ca8429fdbad2486faf4192312ce6c4b322772e038f01a8","urls":["bzz-raw://0cf520d5984e253a2d2a9abe195c2d8a6c33b3cddc049175e93a5f22e9972c11","dweb:/ipfs/QmP8rkFEMhx8X7jxtRUkLcq3MdFkTr3nxzof3vzwGhab8p"],"license":"GPL-2.0-or-later"}},"version":1},"ast":{"absolutePath":"lib/metamorpho/lib/morpho-blue/src/libraries/SharesMathLib.sol","id":84786,"exportedSymbols":{"MathLib":[84676],"SharesMathLib":[84785]},"nodeType":"SourceUnit","src":"45:2315:49","nodes":[{"id":84678,"nodeType":"PragmaDirective","src":"45:23:49","nodes":[],"literals":["solidity","^","0.8",".0"]},{"id":84680,"nodeType":"ImportDirective","src":"70:38:49","nodes":[],"absolutePath":"lib/metamorpho/lib/morpho-blue/src/libraries/MathLib.sol","file":"./MathLib.sol","nameLocation":"-1:-1:-1","scope":84786,"sourceUnit":84677,"symbolAliases":[{"foreign":{"id":84679,"name":"MathLib","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":84676,"src":"78:7:49","typeDescriptions":{}},"nameLocation":"-1:-1:-1"}],"unitAlias":""},{"id":84785,"nodeType":"ContractDefinition","src":"425:1934:49","nodes":[{"id":84684,"nodeType":"UsingForDirective","src":"453:26:49","nodes":[],"global":false,"libraryName":{"id":84682,"name":"MathLib","nameLocations":["459:7:49"],"nodeType":"IdentifierPath","referencedDeclaration":84676,"src":"459:7:49"},"typeName":{"id":84683,"name":"uint256","nodeType":"ElementaryTypeName","src":"471:7:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}}},{"id":84688,"nodeType":"VariableDeclaration","src":"949:46:49","nodes":[],"constant":true,"documentation":{"id":84685,"nodeType":"StructuredDocumentation","src":"485:459:49","text":"@dev The number of virtual shares has been chosen low enough to prevent overflows, and high enough to ensure\n high precision computations.\n @dev Virtual shares can never be redeemed for the assets they are entitled to, but it is assumed the share price\n stays low enough not to inflate these assets to a significant value.\n @dev Warning: The assets to which virtual borrow shares are entitled behave like unrealizable bad debt."},"mutability":"constant","name":"VIRTUAL_SHARES","nameLocation":"975:14:49","scope":84785,"stateVariable":true,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":84686,"name":"uint256","nodeType":"ElementaryTypeName","src":"949:7:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"value":{"hexValue":"316536","id":84687,"isConstant":false,"isLValue":false,"isPure":true,"kind":"number","lValueRequested":false,"nodeType":"Literal","src":"992:3:49","typeDescriptions":{"typeIdentifier":"t_rational_1000000_by_1","typeString":"int_const 1000000"},"value":"1e6"},"visibility":"internal"},{"id":84692,"nodeType":"VariableDeclaration","src":"1132:44:49","nodes":[],"constant":true,"documentation":{"id":84689,"nodeType":"StructuredDocumentation","src":"1002:125:49","text":"@dev A number of virtual assets of 1 enforces a conversion rate between shares and assets when a market is\n empty."},"mutability":"constant","name":"VIRTUAL_ASSETS","nameLocation":"1158:14:49","scope":84785,"stateVariable":true,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":84690,"name":"uint256","nodeType":"ElementaryTypeName","src":"1132:7:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"value":{"hexValue":"31","id":84691,"isConstant":false,"isLValue":false,"isPure":true,"kind":"number","lValueRequested":false,"nodeType":"Literal","src":"1175:1:49","typeDescriptions":{"typeIdentifier":"t_rational_1_by_1","typeString":"int_const 1"},"value":"1"},"visibility":"internal"},{"id":84715,"nodeType":"FunctionDefinition","src":"1262:213:49","nodes":[],"body":{"id":84714,"nodeType":"Block","src":"1374:101:49","nodes":[],"statements":[{"expression":{"arguments":[{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":84708,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":84706,"name":"totalShares","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":84699,"src":"1409:11:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"+","rightExpression":{"id":84707,"name":"VIRTUAL_SHARES","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":84688,"src":"1423:14:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"1409:28:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":84711,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":84709,"name":"totalAssets","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":84697,"src":"1439:11:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"+","rightExpression":{"id":84710,"name":"VIRTUAL_ASSETS","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":84692,"src":"1453:14:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"1439:28:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_uint256","typeString":"uint256"},{"typeIdentifier":"t_uint256","typeString":"uint256"}],"expression":{"id":84704,"name":"assets","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":84695,"src":"1391:6:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"id":84705,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"1398:10:49","memberName":"mulDivDown","nodeType":"MemberAccess","referencedDeclaration":84607,"src":"1391:17:49","typeDescriptions":{"typeIdentifier":"t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$","typeString":"function (uint256,uint256,uint256) pure returns (uint256)"}},"id":84712,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"1391:77:49","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"functionReturnParameters":84703,"id":84713,"nodeType":"Return","src":"1384:84:49"}]},"documentation":{"id":84693,"nodeType":"StructuredDocumentation","src":"1183:74:49","text":"@dev Calculates the value of `assets` quoted in shares, rounding down."},"implemented":true,"kind":"function","modifiers":[],"name":"toSharesDown","nameLocation":"1271:12:49","parameters":{"id":84700,"nodeType":"ParameterList","parameters":[{"constant":false,"id":84695,"mutability":"mutable","name":"assets","nameLocation":"1292:6:49","nodeType":"VariableDeclaration","scope":84715,"src":"1284:14:49","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":84694,"name":"uint256","nodeType":"ElementaryTypeName","src":"1284:7:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},{"constant":false,"id":84697,"mutability":"mutable","name":"totalAssets","nameLocation":"1308:11:49","nodeType":"VariableDeclaration","scope":84715,"src":"1300:19:49","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":84696,"name":"uint256","nodeType":"ElementaryTypeName","src":"1300:7:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},{"constant":false,"id":84699,"mutability":"mutable","name":"totalShares","nameLocation":"1329:11:49","nodeType":"VariableDeclaration","scope":84715,"src":"1321:19:49","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":84698,"name":"uint256","nodeType":"ElementaryTypeName","src":"1321:7:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"src":"1283:58:49"},"returnParameters":{"id":84703,"nodeType":"ParameterList","parameters":[{"constant":false,"id":84702,"mutability":"mutable","name":"","nameLocation":"-1:-1:-1","nodeType":"VariableDeclaration","scope":84715,"src":"1365:7:49","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":84701,"name":"uint256","nodeType":"ElementaryTypeName","src":"1365:7:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"src":"1364:9:49"},"scope":84785,"stateMutability":"pure","virtual":false,"visibility":"internal"},{"id":84738,"nodeType":"FunctionDefinition","src":"1560:213:49","nodes":[],"body":{"id":84737,"nodeType":"Block","src":"1672:101:49","nodes":[],"statements":[{"expression":{"arguments":[{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":84731,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":84729,"name":"totalAssets","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":84720,"src":"1707:11:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"+","rightExpression":{"id":84730,"name":"VIRTUAL_ASSETS","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":84692,"src":"1721:14:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"1707:28:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":84734,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":84732,"name":"totalShares","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":84722,"src":"1737:11:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"+","rightExpression":{"id":84733,"name":"VIRTUAL_SHARES","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":84688,"src":"1751:14:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"1737:28:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_uint256","typeString":"uint256"},{"typeIdentifier":"t_uint256","typeString":"uint256"}],"expression":{"id":84727,"name":"shares","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":84718,"src":"1689:6:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"id":84728,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"1696:10:49","memberName":"mulDivDown","nodeType":"MemberAccess","referencedDeclaration":84607,"src":"1689:17:49","typeDescriptions":{"typeIdentifier":"t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$","typeString":"function (uint256,uint256,uint256) pure returns (uint256)"}},"id":84735,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"1689:77:49","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"functionReturnParameters":84726,"id":84736,"nodeType":"Return","src":"1682:84:49"}]},"documentation":{"id":84716,"nodeType":"StructuredDocumentation","src":"1481:74:49","text":"@dev Calculates the value of `shares` quoted in assets, rounding down."},"implemented":true,"kind":"function","modifiers":[],"name":"toAssetsDown","nameLocation":"1569:12:49","parameters":{"id":84723,"nodeType":"ParameterList","parameters":[{"constant":false,"id":84718,"mutability":"mutable","name":"shares","nameLocation":"1590:6:49","nodeType":"VariableDeclaration","scope":84738,"src":"1582:14:49","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":84717,"name":"uint256","nodeType":"ElementaryTypeName","src":"1582:7:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},{"constant":false,"id":84720,"mutability":"mutable","name":"totalAssets","nameLocation":"1606:11:49","nodeType":"VariableDeclaration","scope":84738,"src":"1598:19:49","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":84719,"name":"uint256","nodeType":"ElementaryTypeName","src":"1598:7:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},{"constant":false,"id":84722,"mutability":"mutable","name":"totalShares","nameLocation":"1627:11:49","nodeType":"VariableDeclaration","scope":84738,"src":"1619:19:49","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":84721,"name":"uint256","nodeType":"ElementaryTypeName","src":"1619:7:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"src":"1581:58:49"},"returnParameters":{"id":84726,"nodeType":"ParameterList","parameters":[{"constant":false,"id":84725,"mutability":"mutable","name":"","nameLocation":"-1:-1:-1","nodeType":"VariableDeclaration","scope":84738,"src":"1663:7:49","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":84724,"name":"uint256","nodeType":"ElementaryTypeName","src":"1663:7:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"src":"1662:9:49"},"scope":84785,"stateMutability":"pure","virtual":false,"visibility":"internal"},{"id":84761,"nodeType":"FunctionDefinition","src":"1856:209:49","nodes":[],"body":{"id":84760,"nodeType":"Block","src":"1966:99:49","nodes":[],"statements":[{"expression":{"arguments":[{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":84754,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":84752,"name":"totalShares","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":84745,"src":"1999:11:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"+","rightExpression":{"id":84753,"name":"VIRTUAL_SHARES","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":84688,"src":"2013:14:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"1999:28:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":84757,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":84755,"name":"totalAssets","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":84743,"src":"2029:11:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"+","rightExpression":{"id":84756,"name":"VIRTUAL_ASSETS","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":84692,"src":"2043:14:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"2029:28:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_uint256","typeString":"uint256"},{"typeIdentifier":"t_uint256","typeString":"uint256"}],"expression":{"id":84750,"name":"assets","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":84741,"src":"1983:6:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"id":84751,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"1990:8:49","memberName":"mulDivUp","nodeType":"MemberAccess","referencedDeclaration":84632,"src":"1983:15:49","typeDescriptions":{"typeIdentifier":"t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$","typeString":"function (uint256,uint256,uint256) pure returns (uint256)"}},"id":84758,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"1983:75:49","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"functionReturnParameters":84749,"id":84759,"nodeType":"Return","src":"1976:82:49"}]},"documentation":{"id":84739,"nodeType":"StructuredDocumentation","src":"1779:72:49","text":"@dev Calculates the value of `assets` quoted in shares, rounding up."},"implemented":true,"kind":"function","modifiers":[],"name":"toSharesUp","nameLocation":"1865:10:49","parameters":{"id":84746,"nodeType":"ParameterList","parameters":[{"constant":false,"id":84741,"mutability":"mutable","name":"assets","nameLocation":"1884:6:49","nodeType":"VariableDeclaration","scope":84761,"src":"1876:14:49","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":84740,"name":"uint256","nodeType":"ElementaryTypeName","src":"1876:7:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},{"constant":false,"id":84743,"mutability":"mutable","name":"totalAssets","nameLocation":"1900:11:49","nodeType":"VariableDeclaration","scope":84761,"src":"1892:19:49","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":84742,"name":"uint256","nodeType":"ElementaryTypeName","src":"1892:7:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},{"constant":false,"id":84745,"mutability":"mutable","name":"totalShares","nameLocation":"1921:11:49","nodeType":"VariableDeclaration","scope":84761,"src":"1913:19:49","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":84744,"name":"uint256","nodeType":"ElementaryTypeName","src":"1913:7:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"src":"1875:58:49"},"returnParameters":{"id":84749,"nodeType":"ParameterList","parameters":[{"constant":false,"id":84748,"mutability":"mutable","name":"","nameLocation":"-1:-1:-1","nodeType":"VariableDeclaration","scope":84761,"src":"1957:7:49","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":84747,"name":"uint256","nodeType":"ElementaryTypeName","src":"1957:7:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"src":"1956:9:49"},"scope":84785,"stateMutability":"pure","virtual":false,"visibility":"internal"},{"id":84784,"nodeType":"FunctionDefinition","src":"2148:209:49","nodes":[],"body":{"id":84783,"nodeType":"Block","src":"2258:99:49","nodes":[],"statements":[{"expression":{"arguments":[{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":84777,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":84775,"name":"totalAssets","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":84766,"src":"2291:11:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"+","rightExpression":{"id":84776,"name":"VIRTUAL_ASSETS","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":84692,"src":"2305:14:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"2291:28:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":84780,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":84778,"name":"totalShares","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":84768,"src":"2321:11:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"+","rightExpression":{"id":84779,"name":"VIRTUAL_SHARES","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":84688,"src":"2335:14:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"2321:28:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_uint256","typeString":"uint256"},{"typeIdentifier":"t_uint256","typeString":"uint256"}],"expression":{"id":84773,"name":"shares","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":84764,"src":"2275:6:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"id":84774,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"2282:8:49","memberName":"mulDivUp","nodeType":"MemberAccess","referencedDeclaration":84632,"src":"2275:15:49","typeDescriptions":{"typeIdentifier":"t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$","typeString":"function (uint256,uint256,uint256) pure returns (uint256)"}},"id":84781,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"2275:75:49","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"functionReturnParameters":84772,"id":84782,"nodeType":"Return","src":"2268:82:49"}]},"documentation":{"id":84762,"nodeType":"StructuredDocumentation","src":"2071:72:49","text":"@dev Calculates the value of `shares` quoted in assets, rounding up."},"implemented":true,"kind":"function","modifiers":[],"name":"toAssetsUp","nameLocation":"2157:10:49","parameters":{"id":84769,"nodeType":"ParameterList","parameters":[{"constant":false,"id":84764,"mutability":"mutable","name":"shares","nameLocation":"2176:6:49","nodeType":"VariableDeclaration","scope":84784,"src":"2168:14:49","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":84763,"name":"uint256","nodeType":"ElementaryTypeName","src":"2168:7:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},{"constant":false,"id":84766,"mutability":"mutable","name":"totalAssets","nameLocation":"2192:11:49","nodeType":"VariableDeclaration","scope":84784,"src":"2184:19:49","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":84765,"name":"uint256","nodeType":"ElementaryTypeName","src":"2184:7:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},{"constant":false,"id":84768,"mutability":"mutable","name":"totalShares","nameLocation":"2213:11:49","nodeType":"VariableDeclaration","scope":84784,"src":"2205:19:49","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":84767,"name":"uint256","nodeType":"ElementaryTypeName","src":"2205:7:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"src":"2167:58:49"},"returnParameters":{"id":84772,"nodeType":"ParameterList","parameters":[{"constant":false,"id":84771,"mutability":"mutable","name":"","nameLocation":"-1:-1:-1","nodeType":"VariableDeclaration","scope":84784,"src":"2249:7:49","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":84770,"name":"uint256","nodeType":"ElementaryTypeName","src":"2249:7:49","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"src":"2248:9:49"},"scope":84785,"stateMutability":"pure","virtual":false,"visibility":"internal"}],"abstract":false,"baseContracts":[],"canonicalName":"SharesMathLib","contractDependencies":[],"contractKind":"library","documentation":{"id":84681,"nodeType":"StructuredDocumentation","src":"110:315:49","text":"@title SharesMathLib\n @author Morpho Labs\n @custom:contact security@morpho.org\n @notice Shares management library.\n @dev This implementation mitigates share price manipulations, using OpenZeppelin's method of virtual shares:\n https://docs.openzeppelin.com/contracts/4.x/erc4626#inflation-attack."},"fullyImplemented":true,"linearizedBaseContracts":[84785],"name":"SharesMathLib","nameLocation":"433:13:49","scope":84786,"usedErrors":[],"usedEvents":[]}],"license":"GPL-2.0-or-later"},"id":49}